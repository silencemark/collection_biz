<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.collection.dao.IAppIndexMapper">

	<select id="getHomePageBanner" parameterType="map" resultType="map">
	    select bannerid, imgurl, httpurl, type, status, DATE_FORMAT(createtime,'%Y-%m-%d %H:%i:%S') as createtime, createid, description from  c_t_app_banner
	    <where>
	        <if test="type != null and type != ''">and type=#{type}</if>
	        and status = 1
	    </where>
	</select>
	
	<select id="getAdvertisement" parameterType="map" resultType="map">
	    select advertid, advertcontent, imgurl, httpurl, DATE_FORMAT(createtime,'%Y-%m-%d %H:%i:%S') as createtime, createid from  c_t_app_advert
	</select>
	
	<select id="getHomePageMovie" parameterType="map" resultType="map">
	    select type, coverimg, title, httpurl, description
	    from  c_t_app_movie
	    <where>
	        <if test="type != null and type != '' and type != 0">and type=#{type}</if>
	        and status = 1
	    </where>
	</select>
	
	<select id="getMemberMovieList" parameterType="map" resultType="map">
	    select 1 as type ,max(A.coverimg) coverimg,A.title,max(A.httpurl) as httpurl,max(A.description) as description
		from (select mo.movieid, mo.coverimg, mo.title, mo.httpurl, mo.description 
	    from c_t_app_order ao
	    left join c_t_app_membermovie mo on ao.cardid = mo.cardid and mo.status = 1
		<where>
	        <if test="userid != null and userid != '' ">and ao.buyuserid=#{userid}</if>
	         and ao.status = 3
	         and mo.movieid is not null
	    </where>
		) A group by A.title 
	</select>
	
	
</mapper>